<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · SGCRNAs.jl</title><meta name="title" content="Tutorial · SGCRNAs.jl"/><meta property="og:title" content="Tutorial · SGCRNAs.jl"/><meta property="twitter:title" content="Tutorial · SGCRNAs.jl"/><meta name="description" content="Documentation for SGCRNAs.jl."/><meta property="og:description" content="Documentation for SGCRNAs.jl."/><meta property="twitter:description" content="Documentation for SGCRNAs.jl."/><meta property="og:url" content="https://C37H41N2O6.github.io/SGCRNAs.jl/tutorial/"/><meta property="twitter:url" content="https://C37H41N2O6.github.io/SGCRNAs.jl/tutorial/"/><link rel="canonical" href="https://C37H41N2O6.github.io/SGCRNAs.jl/tutorial/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SGCRNAs.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li class="is-active"><a class="tocitem" href>Tutorial</a><ul class="internal"><li><a class="tocitem" href="#1.-Preparation"><span>1. Preparation</span></a></li><li><a class="tocitem" href="#2.-Pre-processing"><span>2. Pre-processing</span></a></li><li><a class="tocitem" href="#3.-Clustering"><span>3. Clustering</span></a></li><li><a class="tocitem" href="#4.-Draw-Network"><span>4. Draw Network</span></a></li><li><a class="tocitem" href="#5.-Correlation-Between-Modules-and-Phenomena"><span>5. Correlation Between Modules and Phenomena</span></a></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/C37H41N2O6/SGCRNAs.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/C37H41N2O6/SGCRNAs.jl/blob/main/docs/src/tutorial.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial"><a class="docs-heading-anchor" href="#Tutorial">Tutorial</a><a id="Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial" title="Permalink"></a></h1><p>In this tutorial, we use the dataset <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE114007">GSE114007</a>, as described in the SGCRNA publication.</p><ul><li><a href="../assets/normalizedCounts_coding.tsv">RNA expression matrix</a></li><li><a href="../assets/SraRunTable.csv">clinical data</a></li></ul><h2 id="1.-Preparation"><a class="docs-heading-anchor" href="#1.-Preparation">1. Preparation</a><a id="1.-Preparation-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Preparation" title="Permalink"></a></h2><p>Load the required packages and files.</p><pre><code class="language-julia hljs">using CSV, DataFrames
using SGCRNAs

# Load Data
Data = CSV.read(&quot;normalizedCounts_coding.tsv&quot;, header=1, comment=&quot;#&quot;, delim=&#39;\t&#39;, DataFrame);
Phen = CSV.read(&quot;SraRunTable.csv&quot;, header=1, comment=&quot;#&quot;, delim=&#39;,&#39;, DataFrame);</code></pre><h2 id="2.-Pre-processing"><a class="docs-heading-anchor" href="#2.-Pre-processing">2. Pre-processing</a><a id="2.-Pre-processing-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Pre-processing" title="Permalink"></a></h2><p>Preprocessing of the data is performed using the CGM function.   The first argument takes a vector of variable names, and the second argument takes a matrix of values. The value matrix must have variables as rows and samples as columns.   An optional argument, <code>mode</code> (default: <code>:NONE</code>), can be set to <code>:LESS</code>, <code>:SIGMA</code>, or <code>:FTEST</code>. If any of these modes are specified, a plot will be generated and saved in the current directory, with the range of values to be removed highlighted in red. Regardless of which mode is selected, all modes other than <code>:NONE</code> will be included in the output figure.</p><pre><code class="language-julia hljs">CorData, GradData = CGM(Data.Symbol, Matrix(Data[:,5:end]), mode=:FTEST);</code></pre><p><img src="../assets/freqCurve.png" alt/> <code>CorData</code> is a DataFrame representing the correlation matrix, and <code>GradData</code> is a DataFrame representing the regression coefficient matrix.</p><h2 id="3.-Clustering"><a class="docs-heading-anchor" href="#3.-Clustering">3. Clustering</a><a id="3.-Clustering-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Clustering" title="Permalink"></a></h2><p>Clustering is performed using the results obtained in the previous step.   In general, it is not necessary to change the optional arguments. However, if the number of variables is small, consider reducing the values of tNodeNum (default: 100) and pcas (default: 99). It is recommended that both values be set to less than approximately one-tenth of the total number of variables, but no less than 3.</p><pre><code class="language-julia hljs">clust, pos, edge_data = SpectralClustering(CorData, GradData);</code></pre><p>The clustering results are stored in <code>clust</code>.   Due to the sub-clustering process performed according to the conditions specified by the optional arguments of the function — <code>tNodeNum</code> (default: 100, the maximum number of nodes in a module) and <code>depthMax</code> (default: 5, the maximum number of sub-clustering iterations) — the results are returned as a vector of vectors. In most cases, you can simply use the vector at index 1. However, if you wish to perform more fine-grained clustering, you may use other elements as well.</p><h2 id="4.-Draw-Network"><a class="docs-heading-anchor" href="#4.-Draw-Network">4. Draw Network</a><a id="4.-Draw-Network-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Draw-Network" title="Permalink"></a></h2><p>Specify the modules you wish to visualise using <code>SetNetwork</code>, and draw the network graph with <code>DrawNetwork</code>. By passing a vector of module numbers to the optional argument <code>il</code> in <code>SetNetwork</code>, only the specified modules will be displayed. If <code>il</code> is not specified, all modules will be drawn.</p><pre><code class="language-julia hljs">d = 1; k = maximum(clust[d]);
nw, new_pos, cnctdf, new_clust, score = SetNetwork(edge_data, clust[d], pos, il=[1,13,62]);
DrawNetwork(&quot;Result/Fig/NetWork.png&quot;, nw, new_pos, cnctdf, new_clust, k, node_scores=score);</code></pre><p><img src="../assets/NetWork.png" alt/></p><h2 id="5.-Correlation-Between-Modules-and-Phenomena"><a class="docs-heading-anchor" href="#5.-Correlation-Between-Modules-and-Phenomena">5. Correlation Between Modules and Phenomena</a><a id="5.-Correlation-Between-Modules-and-Phenomena-1"></a><a class="docs-heading-anchor-permalink" href="#5.-Correlation-Between-Modules-and-Phenomena" title="Permalink"></a></h2><p>By comparing the modules with other parameters associated with the samples, it is possible to investigate which modules are related to specific parameters. In this example, the parameters include sex, osteoarthritis grade, and age.   It is important to note that, unlike the expression matrix, the parameter data is structured with samples as rows and parameters as columns.   Naturally, the order of the samples (i.e., the column order in the expression matrix) must match the order of the samples in the parameter data.</p><pre><code class="language-julia hljs">Data = innerjoin(Data, DataFrame(Symbol=unique(vcat(cnctdf.e1,cnctdf.e2))), on=:Symbol, order=:right);
CorPhenMod(Data[:,5:end], Phen[:,[2,3,5]], new_clust, &quot;Result/Fig/CorPhenMod.png&quot;);</code></pre><p><img src="../assets/CorPhenMod.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../quickstart/">« Quick Start</a><a class="docs-footer-nextpage" href="../reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Wednesday 4 June 2025 07:32">Wednesday 4 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
